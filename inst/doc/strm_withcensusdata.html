<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Introduction</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>

<!-- MathJax scripts -->
<script type="text/javascript" src="https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<pre><code class="r">#load libraries:
#load strm
library(strm)
library(rmarkdown)
#load package dependencies for the vignette
library(tidyr)
library(gt)
library(dplyr)
library(ggplot2)
library(patchwork)
library(purrr)
library(rgdal)
library(spdep)
</code></pre>

<p><code>strm</code> is an <code>R</code> package that fits spatio-temporal regression model based on Chi &amp; Zhu <em>Spatial Regression Models for the Social Sciences</em> (2019). The approach here fits a spatial error model while incorporating a temporally lagged response variable and temporally lagged explanatory variables.</p>

<p>This package builds on the <code>errorsarlm()</code> function from the <code>spatialreg</code> package.</p>

<p>This package is still under development. Please report bugs or constructive tips to issues <a href="https://github.com/mkamenet3/strm/issues">here</a>.</p>

<h1>Introduction</h1>

<p>This data example will work through downloading census data using the <code>tidycensus</code> package, creating spatial weights, and then using <code>strm</code> to fit the spatio-temporal regression model. We will fit the same model using both the <em>long</em> and <em>wide</em> data formats.</p>

<p>In this example, we want to look at percent poverty as it relates to female employment rates at the Wisconsin county-level. We will use the American Community Survey (ACS) 5-year data. The variables we will extract are:</p>

<ul>
<li><code>B17020_002</code> - Estimate: Total - Income in the past 12 months below poverty level</li>
<li><code>B17020_001</code> - Estimate: Total - Poverty Status in the past 12 months.</li>
<li><code>B23022_026</code> - Estimate: Total Female by Work Status by weeks worked in the past 12 months for the population 16-64 years old.</li>
<li><code>B23022_001</code> - Estimate: Total: status in the past 12 months by usual hours worked per week in the past 12 months by weeks worked in the past 12 months for the population 16-64 years old (Male and Female)</li>
</ul>

<p>We first load in the dataset <code>wi_raw</code> that contains the raw 5-year estimates from two years: 2013-2017 and 2014-2018 ACS data at the county-level in Wisconsin using <code>data(wi_raw)</code>:</p>

<pre><code class="r">data(wi_raw)
</code></pre>

<p>We first explore the raw Wisconsin data:</p>

<pre><code class="r">class(wi_raw)
</code></pre>

<pre><code>## [1] &quot;sf&quot;         &quot;data.frame&quot;
</code></pre>

<pre><code class="r">names(wi_raw)
</code></pre>

<pre><code>## [1] &quot;GEOID&quot;    &quot;NAME&quot;     &quot;variable&quot; &quot;estimate&quot; &quot;moe&quot;      &quot;id&quot;       &quot;geometry&quot;
</code></pre>

<pre><code class="r">str(wi_raw)
</code></pre>

<pre><code>## Classes &#39;sf&#39; and &#39;data.frame&#39;:   576 obs. of  7 variables:
##  $ GEOID   : chr  &quot;55043&quot; &quot;55043&quot; &quot;55043&quot; &quot;55043&quot; ...
##  $ NAME    : chr  &quot;Grant County, Wisconsin&quot; &quot;Grant County, Wisconsin&quot; &quot;Grant County, Wisconsin&quot; &quot;Grant County, Wisconsin&quot; ...
##  $ variable: chr  &quot;B17020_001&quot; &quot;B17020_002&quot; &quot;B23022_001&quot; &quot;B23022_026&quot; ...
##  $ estimate: num  47928 7323 33826 15433 15929 ...
##  $ moe     : num  311 554 87 74 113 322 56 43 38 166 ...
##  $ id      : num  2017 2017 2017 2017 2017 ...
##  $ geometry:sfc_MULTIPOLYGON of length 576; first list element: List of 1
##   ..$ :List of 1
##   .. ..$ : num [1:423, 1:2] -91.2 -91.2 -91.1 -91.1 -91.1 ...
##   ..- attr(*, &quot;class&quot;)= chr [1:3] &quot;XY&quot; &quot;MULTIPOLYGON&quot; &quot;sfg&quot;
##  - attr(*, &quot;sf_column&quot;)= chr &quot;geometry&quot;
##  - attr(*, &quot;agr&quot;)= Factor w/ 3 levels &quot;constant&quot;,&quot;aggregate&quot;,..: NA NA NA NA NA NA
##   ..- attr(*, &quot;names&quot;)= chr [1:6] &quot;GEOID&quot; &quot;NAME&quot; &quot;variable&quot; &quot;estimate&quot; ...
</code></pre>

<pre><code class="r">head(wi_raw)
</code></pre>

<pre><code>## Simple feature collection with 6 features and 6 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -91.5518 ymin: 42.50706 xmax: -90.4258 ymax: 46.15791
## Geodetic CRS:  NAD83
##   GEOID                     NAME   variable estimate moe   id
## 1 55043  Grant County, Wisconsin B17020_001    47928 311 2017
## 2 55043  Grant County, Wisconsin B17020_002     7323 554 2017
## 3 55043  Grant County, Wisconsin B23022_001    33826  87 2017
## 4 55043  Grant County, Wisconsin B23022_026    15433  74 2017
## 5 55113 Sawyer County, Wisconsin B17020_001    15929 113 2017
## 6 55113 Sawyer County, Wisconsin B17020_002     2825 322 2017
##                         geometry
## 1 MULTIPOLYGON (((-91.15681 4...
## 2 MULTIPOLYGON (((-91.15681 4...
## 3 MULTIPOLYGON (((-91.15681 4...
## 4 MULTIPOLYGON (((-91.15681 4...
## 5 MULTIPOLYGON (((-91.55095 4...
## 6 MULTIPOLYGON (((-91.55095 4...
</code></pre>

<p>Notice that <code>wi_raw</code> is of class <code>sf</code> and class <code>data.frame</code></p>

<h2>Long-Form Data</h2>

<h3>Exploratory (Spatial) Data Analysis</h3>

<p>We first clean the data in order to calculate percent of each year-county population that is in poverty and percent female employment rate. We also take the natural log transformation of the poverty percent rate. We first use <code>select()</code> from <code>dplyr</code> to select out the <code>moe</code> (margin of error) variable as we do  not need it for this analysis. We then use <code>spread</code> from <code>tidyr</code> to reformat the key variables from long to wide format so that we can then use <code>mutate()</code> from <code>dplyr</code> to create new variables (<code>pov_prct</code>, <code>feemp_prct</code>, <code>id</code>, <code>logpov</code>). Note this dataset is still in <code>long</code> format because there are multiple observations for each county due to multiple years.</p>

<pre><code class="r">wi &lt;- wi_raw %&gt;%
    dplyr::select(-moe) %&gt;%
    spread(key = variable, value=estimate) %&gt;%
    mutate(pov_prct = B17020_002/B17020_001,
           feemp_prct = B23022_026/B23022_001,
           year=id,
           logpov = log(pov_prct)) 

wi &lt;- st_transform(wi, 4326)
class(wi)
</code></pre>

<pre><code>## [1] &quot;sf&quot;         &quot;data.frame&quot;
</code></pre>

<pre><code class="r">str(wi)
</code></pre>

<pre><code>## Classes &#39;sf&#39; and &#39;data.frame&#39;:   144 obs. of  12 variables:
##  $ GEOID     : chr  &quot;55001&quot; &quot;55001&quot; &quot;55003&quot; &quot;55003&quot; ...
##  $ NAME      : chr  &quot;Adams County, Wisconsin&quot; &quot;Adams County, Wisconsin&quot; &quot;Ashland County, Wisconsin&quot; &quot;Ashland County, Wisconsin&quot; ...
##  $ id        : num  2017 2018 2017 2018 2017 ...
##  $ B17020_001: num  18962 18940 15164 15088 44510 ...
##  $ B17020_002: num  2457 2794 2215 2161 5138 ...
##  $ B23022_001: num  11964 11851 9889 9771 27406 ...
##  $ B23022_026: num  5303 5233 4899 4798 13333 ...
##  $ geometry  :sfc_MULTIPOLYGON of length 144; first list element: List of 1
##   ..$ :List of 1
##   .. ..$ : num [1:312, 1:2] -90 -90 -90 -90 -90 ...
##   ..- attr(*, &quot;class&quot;)= chr [1:3] &quot;XY&quot; &quot;MULTIPOLYGON&quot; &quot;sfg&quot;
##  $ pov_prct  : num  0.13 0.148 0.146 0.143 0.115 ...
##  $ feemp_prct: num  0.443 0.442 0.495 0.491 0.486 ...
##  $ year      : num  2017 2018 2017 2018 2017 ...
##  $ logpov    : num  -2.04 -1.91 -1.92 -1.94 -2.16 ...
##  - attr(*, &quot;sf_column&quot;)= chr &quot;geometry&quot;
##  - attr(*, &quot;agr&quot;)= Factor w/ 3 levels &quot;constant&quot;,&quot;aggregate&quot;,..: NA NA NA NA NA NA NA NA NA NA ...
##   ..- attr(*, &quot;names&quot;)= chr [1:11] &quot;GEOID&quot; &quot;NAME&quot; &quot;id&quot; &quot;B17020_001&quot; ...
</code></pre>

<p>Let us explore the summary statistics by year for <code>pov_prct</code> using <code>summary()</code> and the <code>tapply()</code> function:</p>

<pre><code class="r">summary(wi$pov_prct)
</code></pre>

<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## 0.04454 0.09203 0.11502 0.11734 0.13586 0.35843
</code></pre>

<pre><code class="r">tapply(wi$pov_prct, wi$year, summary)
</code></pre>

<pre><code>## $`2017`
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## 0.04760 0.09203 0.11505 0.11946 0.13736 0.35843 
## 
## $`2018`
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## 0.04454 0.09300 0.11475 0.11521 0.13356 0.32647
</code></pre>

<p>We also the summary statistics by year for <code>feemp_prct</code></p>

<pre><code class="r">summary(wi$feemp_prct)
</code></pre>

<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.4416  0.4841  0.4900  0.4874  0.4955  0.5122
</code></pre>

<pre><code class="r">tapply(wi$feemp_prct, wi$year, summary)
</code></pre>

<pre><code>## $`2017`
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.4432  0.4840  0.4892  0.4874  0.4954  0.5117 
## 
## $`2018`
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.4416  0.4844  0.4906  0.4875  0.4958  0.5122
</code></pre>

<p>Finally, we look at correlation between percent poverty and percent female employment across all 2 years of ACS data:</p>

<pre><code class="r">cor(wi$pov_prct,wi$feemp_prct)
</code></pre>

<pre><code>## [1] -0.06646265
</code></pre>

<p>We next visually explore the data using the <code>geom_histogram()</code> and <code>geom_density()</code> geometries from the <code>ggplot2</code> package.</p>

<p>We first explore percent poverty (<code>pov_prct</code>) and the log-transformed percent poverty (<code>logpov</code>):</p>

<pre><code class="r">ggplot(data=wi, aes(x=pov_prct)) +
    facet_grid(.~ year) +
    geom_histogram(binwidth=0.01,color=&quot;black&quot;, aes(fill=factor(year))) +
    geom_density(alpha=.2, aes(fill=factor(year))) +
    theme_minimal() +
    xlab(&quot;Percent Poverty&quot;) +
    labs(title=&quot;County-Level Percent Poverty in Wisconsin Across Time&quot;, fill=&quot;Year&quot;) +
    theme(plot.title = element_text(hjust = 0.5),
          legend.position = &quot;none&quot;) +
    scale_fill_manual(values=c(&quot;chartreuse4&quot;, &quot;deeppink4&quot;, &quot;cornflowerblue&quot;,&quot;orange2&quot;,&quot;tomato3&quot;))
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-8"/></p>

<pre><code class="r">breaks &lt;- quantile(wi$logpov,seq(0,1,by=0.1))
ggplot(data=wi, aes(x=logpov)) +
    geom_histogram(aes(y =..density.., fill=factor(year)),color=&quot;black&quot;, breaks=breaks) +
    facet_grid(.~ year) +
    geom_density(alpha=.2, aes(fill=factor(year))) +
    theme_minimal() +
    xlab(&quot;(Log) Percent Poverty&quot;) +
    labs(title=&quot;County-Level (Log) Percent Poverty in Wisconsin Across Time&quot;, fill=&quot;Year&quot;) +
    theme(plot.title = element_text(hjust = 0.5),
          legend.position = &quot;none&quot;) +
    scale_fill_manual(values=c(&quot;chartreuse4&quot;, &quot;deeppink4&quot;, &quot;cornflowerblue&quot;,&quot;orange2&quot;,&quot;tomato3&quot;))
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-8"/></p>

<p>Recall that <code>wi</code> is of class <code>sf</code>. We can use the <code>geom_sf()</code> geometry to easily create maps of both <code>pov_prct</code> and <code>logpov</code>:</p>

<pre><code class="r">ggplot(wi) +
    geom_sf(aes(fill = pov_prct)) +
    scale_fill_viridis_c() +
    coord_sf(datum = NA) +
    facet_grid(. ~ year) +
    theme_minimal()+
    theme(plot.title=element_text(hjust = 0.5)) +
    labs(title = &quot;County-Level Percent Poverty in Wisconsin Across Time&quot;, fill=&quot;%Poverty&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-9"/></p>

<pre><code class="r">ggplot(wi) +
    geom_sf(aes(fill = logpov)) +
    scale_fill_viridis_c() +
    coord_sf(datum = NA) +
    facet_grid(. ~ year) +
    theme_minimal()+
    theme(plot.title=element_text(hjust = 0.5)) +
    labs(title = &quot;County-Level (Log) Percent Poverty in Wisconsin Across Time&quot;, fill=&quot;(Log) %Poverty&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-9"/></p>

<p>Next we visually explore <code>feemp_prct</code>:</p>

<pre><code class="r">ggplot(data=wi, aes(x=feemp_prct)) +
    facet_grid(.~ year) +
    geom_histogram(binwidth=0.01,color=&quot;black&quot;, aes(fill=factor(year))) +
    geom_density(alpha=.2, aes(fill=factor(year))) +
    theme_minimal() +
    xlab(&quot;Percent Female Employment&quot;) +
    labs(title=&quot;County-Level Percent Female Employment in Wisconsin Across Time&quot;, fill=&quot;Year&quot;) +
    theme(plot.title = element_text(hjust = 0.5),
          legend.position = &quot;none&quot;) +
    scale_fill_manual(values=c(&quot;chartreuse4&quot;, &quot;deeppink4&quot;, &quot;cornflowerblue&quot;,&quot;orange2&quot;,&quot;tomato3&quot;))
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-10"/></p>

<pre><code class="r">ggplot(wi) +
    geom_sf(aes(fill = feemp_prct)) +
    scale_fill_viridis_c() +
    coord_sf(datum = NA) +
    facet_grid(. ~ year) +
    theme_minimal()+
    theme(plot.title=element_text(hjust = 0.5)) +
    labs(title = &quot;County-Level Percent Female Employment in Wisconsin Across Time&quot;, fill=&quot;%Feemp&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-11"/></p>

<h3>Create Neighbors</h3>

<p>In order to apply the spatio-temporal model using <code>strm</code>, we need to first define county neighbors. We will define first-order contiguity-based neighborhood structure (Queen&#39;s adjacency) with row-standardized spatial weights. </p>

<p>We have 2 years of data, however the spatial dependence between counties remains the same. Therefore, we will select unique counties to create neighbors and spatial weights. Specifically, we will use the geometries from 2018 using <code>filter()</code> from <code>dplyr</code> and to simplify the data frame we will select just the <code>GEOID</code> and <code>NAME</code> variables using <code>select()</code> from <code>dplyr</code>:</p>

<pre><code class="r">wi_uniq &lt;- wi %&gt;%
    dplyr::filter(year==2018) %&gt;%
    dplyr::select(GEOID, NAME)  
nrow(wi_uniq)
</code></pre>

<pre><code>## [1] 72
</code></pre>

<pre><code class="r">class(wi_uniq)
</code></pre>

<pre><code>## [1] &quot;sf&quot;         &quot;data.frame&quot;
</code></pre>

<p>We now have 72 unique county geometries which correspond to the 72 counties in Wisconsin.</p>

<p>We next create the neighborhood structure using <code>poly2nb()</code> from the <code>spdep</code> package. We set the row names of <code>wi_uniq</code> dataframe to correspond to the county names and then use the argument <code>row.names=row.names(wi_uniq)</code> in <code>poly2nb()</code> so that we can easily identify each element of the neighborhood structure list with a county. Finally, we print the first 6 neighbors using <code>str(head(wi_nb))</code>:</p>

<pre><code class="r">row.names(wi_uniq) &lt;- wi_uniq$NAME
head(row.names(wi_uniq))
</code></pre>

<pre><code>## [1] &quot;Adams County, Wisconsin&quot;    &quot;Ashland County, Wisconsin&quot; 
## [3] &quot;Barron County, Wisconsin&quot;   &quot;Bayfield County, Wisconsin&quot;
## [5] &quot;Brown County, Wisconsin&quot;    &quot;Buffalo County, Wisconsin&quot;
</code></pre>

<pre><code class="r">wi_nb &lt;- poly2nb(wi_uniq, row.names=row.names(wi_uniq))
str(head(wi_nb))
</code></pre>

<pre><code>## List of 6
##  $ : int [1:6] 11 29 39 50 70 72
##  $ : int [1:4] 4 26 51 58
##  $ : int [1:8] 7 9 17 49 55 56 58 66
##  $ : int [1:4] 2 16 58 66
##  $ : int [1:6] 8 31 36 43 45 59
##  $ : int [1:3] 18 47 62
</code></pre>

<p>Now that we have the neighborhood structure, we create the list of spatial weights using <code>nb2listw()</code> from the <code>spdep</code> package and print the class and first 6 elements of the spatial weights list:</p>

<pre><code class="r">listw_w &lt;- nb2listw(wi_nb, style = &quot;W&quot;)
class(listw_w)
</code></pre>

<pre><code>## [1] &quot;listw&quot; &quot;nb&quot;
</code></pre>

<pre><code class="r">str(head(listw_w$weights))
</code></pre>

<pre><code>## List of 6
##  $ : num [1:6] 0.167 0.167 0.167 0.167 0.167 ...
##  $ : num [1:4] 0.25 0.25 0.25 0.25
##  $ : num [1:8] 0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125
##  $ : num [1:4] 0.25 0.25 0.25 0.25
##  $ : num [1:6] 0.167 0.167 0.167 0.167 0.167 ...
##  $ : num [1:3] 0.333 0.333 0.333
</code></pre>

<p>Lastly, we can visualize these neighbors. We first extract the county polygons using <code>st_geometry()</code> from the <code>sf</code> package and save that as the object <code>county_geoms</code>. Next we find the county centroids using <code>st_centroid()</code> from <code>sf</code> on <code>county_geoms</code> and save that as the object <code>cntrd</code>. Lastly, we find the coordinates of the centroids using <code>st_coordinates()</code> on the <code>cntrd</code> object:</p>

<pre><code class="r">county_geoms &lt;- st_geometry(wi_uniq)
cntrd &lt;- st_centroid(county_geoms)
coords &lt;- st_coordinates(cntrd)
head(coords)
</code></pre>

<pre><code>##           X        Y
## 1 -89.77028 43.96915
## 2 -90.67774 46.31502
## 3 -91.84831 45.42355
## 4 -91.20123 46.52309
## 5 -88.00370 44.45278
## 6 -91.75425 44.37959
</code></pre>

<p>We can visualize the county geometries, centroids, and neighborhood:</p>

<pre><code class="r">plot(county_geoms)
plot(listw_w, coords, col=&quot;blue&quot;, add=TRUE)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-16"/></p>

<h3>Using <code>strm</code></h3>

<p>We use the <code>strm()</code> function from the <code>strm</code> package. The first argument is the model formula. Given that the data is in <em>long</em> format, <code>strm</code> will create the lagged values for you as well as the lagged response in the right-hand side of the model. The next argument is <code>id</code>, which we set to &ldquo;NAME&rdquo; as each observation is taken at the county-level. We then specify the name of the data set (<code>data=wi</code>). We set the argument <code>listw=listw_w</code> to the row-standardized list of spatial weights. We set <code>time=2</code> because there are 2 time periods in the dataset. We set  <code>wide=FALSE</code>, thereby specifying that the data is in <em>long</em> format. Lastly, we set the argument <code>returndf=TRUE</code> to return the modified dataframe along with the model output. The default to <code>returndf</code> is <code>FALSE</code> and <code>strm</code> will only return the model output summary.</p>

<pre><code class="r">#create model formula
formula &lt;-as.formula(logpov  ~ feemp_prct)
#use strm
out &lt;- strm(formula, id=&quot;NAME&quot;, data=wi, listw = listw_w, time=2,wide=FALSE, returndf = TRUE)
</code></pre>

<pre><code>## The spatio-temporal regression model fitted:
</code></pre>

<pre><code>## logpov ~ feemp_prct + feemp_prct.Tlag1 + logpov.Tlag1
</code></pre>

<pre><code class="r">#explore model summary output
summary(out$res)
</code></pre>

<pre><code>## 
## Call:spatialreg::errorsarlm(formula = modframe, listw = listw)
## 
## Residuals:
##        Min         1Q     Median         3Q        Max 
## -0.1164060 -0.0271689 -0.0052208  0.0303804  0.1135471 
## 
## Type: error 
## Coefficients: (asymptotic standard errors) 
##                   Estimate Std. Error z value  Pr(&gt;|z|)
## (Intercept)       0.490041   0.194409  2.5207 0.0117131
## feemp_prct       -9.122181   2.765473 -3.2986 0.0009717
## feemp_prct.Tlag1  8.009282   2.792433  2.8682 0.0041280
## logpov.Tlag1      0.992349   0.018244 54.3924 &lt; 2.2e-16
## 
## Lambda: -0.35546, LR test value: 2.9886, p-value: 0.08385
## Asymptotic standard error: 0.18981
##     z-value: -1.8728, p-value: 0.061102
## Wald statistic: 3.5072, p-value: 0.061102
## 
## Log likelihood: 110.748 for error model
## ML residual variance (sigma squared): 0.0026359, (sigma: 0.051341)
## Number of observations: 72 
## Number of parameters estimated: 6 
## AIC: -209.5, (AIC for lm: -208.51)
</code></pre>

<pre><code class="r">#explore modified dataframe used in strm computation
summary(out$modframe)
</code></pre>

<pre><code>##      logpov         feemp_prct     feemp_prct.Tlag1  logpov.Tlag1   
##  Min.   :-3.111   Min.   :0.4416   Min.   :0.4432   Min.   :-3.045  
##  1st Qu.:-2.375   1st Qu.:0.4844   1st Qu.:0.4840   1st Qu.:-2.386  
##  Median :-2.165   Median :0.4906   Median :0.4892   Median :-2.162  
##  Mean   :-2.212   Mean   :0.4875   Mean   :0.4874   Mean   :-2.175  
##  3rd Qu.:-2.013   3rd Qu.:0.4958   3rd Qu.:0.4954   3rd Qu.:-1.985  
##  Max.   :-1.119   Max.   :0.5122   Max.   :0.5117   Max.   :-1.026
</code></pre>

<p>We next explore the model diagnostics. We create a new dataframe called <code>out_df</code> using <code>cbind.data.frame()</code>, which has the model residuals, model standardized residuals, and fitted values.</p>

<pre><code class="r">out_df &lt;- cbind.data.frame(resids = out$res$residuals,
                           stdresids = out$res$residuals/sd(out$res$residuals),
                           fit = out$res$fitted.values)
</code></pre>

<p>Using the model residuals and fitted values, we create a QQ plot and (standardized) residuals vs. fitted plot, and show them both using the <code>+</code> operator from the <code>patchwork</code> R package:</p>

<pre><code class="r">#QQ Plot
p1 &lt;- ggplot(out_df, aes(sample = stdresids)) +
    geom_qq(size = 1) +
    stat_qq_line() +
    theme_minimal() +
    xlab(&quot;Theoretical Quantiles&quot;) +
    ylab(&quot;Standardized Residuals&quot;) +
    ggtitle(&quot;QQ Plot&quot;) + 
    theme(plot.title=element_text(hjust = 0.5))

#Residuals vs. Fitted Plot
p2 &lt;- ggplot(out_df, aes(x=fit, y=stdresids)) +
    geom_point(size = 0.5) +
    geom_hline(yintercept = 0, col=&quot;red&quot;, linetype=&quot;dashed&quot;) +
    theme_minimal() +
    xlab(&quot;Fitted Values&quot;) +
    ylab(&quot;Standardized Residuals&quot;) +
    ggtitle(&quot;Residuals vs. Fitted Plot&quot;) + 
    theme(plot.title=element_text(hjust = 0.5))

p1 + p2
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-19"/></p>

<h2>Wide-Form Data</h2>

<p>Next, we will perform the <strong>same</strong> analysis as above, but will use the data in <em>wide</em> format.</p>

<p>We first clean the dataframe and convert it to wide format using functions from both the <code>dplyr</code> and <code>tidyr</code> packages</p>

<pre><code class="r">wi_w &lt;- as.data.frame(wi_raw) %&gt;%
    dplyr::select(-moe) %&gt;%
    spread(key = variable, value=estimate) %&gt;%
    mutate(pov_prct = B17020_002/B17020_001,
           feemp_prct = B23022_026/B23022_001,
           year=id,
           logpov = log(pov_prct),
           logfeemp = log(pov_prct)) %&gt;%
    dplyr::select(-id, -(B17020_001:B23022_026), - geometry) %&gt;%
    relocate(year, .after=GEOID) %&gt;%
    gather(variable, value, -(GEOID:NAME)) %&gt;%
    unite(temp, variable, year) %&gt;%
    spread(temp, value)

str(wi_w)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    72 obs. of  10 variables:
##  $ GEOID          : chr  &quot;55001&quot; &quot;55003&quot; &quot;55005&quot; &quot;55007&quot; ...
##  $ NAME           : chr  &quot;Adams County, Wisconsin&quot; &quot;Ashland County, Wisconsin&quot; &quot;Barron County, Wisconsin&quot; &quot;Bayfield County, Wisconsin&quot; ...
##  $ feemp_prct_2017: num  0.443 0.495 0.486 0.492 0.497 ...
##  $ feemp_prct_2018: num  0.442 0.491 0.491 0.491 0.498 ...
##  $ logfeemp_2017  : num  -2.04 -1.92 -2.16 -2.21 -2.18 ...
##  $ logfeemp_2018  : num  -1.91 -1.94 -2.12 -2.16 -2.27 ...
##  $ logpov_2017    : num  -2.04 -1.92 -2.16 -2.21 -2.18 ...
##  $ logpov_2018    : num  -1.91 -1.94 -2.12 -2.16 -2.27 ...
##  $ pov_prct_2017  : num  0.13 0.146 0.115 0.11 0.113 ...
##  $ pov_prct_2018  : num  0.148 0.143 0.12 0.115 0.103 ...
</code></pre>

<pre><code class="r">head(wi_w)
</code></pre>

<pre><code>##   GEOID                       NAME feemp_prct_2017 feemp_prct_2018
## 1 55001    Adams County, Wisconsin       0.4432464       0.4415661
## 2 55003  Ashland County, Wisconsin       0.4953989       0.4910449
## 3 55005   Barron County, Wisconsin       0.4864993       0.4908756
## 4 55007 Bayfield County, Wisconsin       0.4923370       0.4906175
## 5 55009    Brown County, Wisconsin       0.4971482       0.4975893
## 6 55011  Buffalo County, Wisconsin       0.4800545       0.4845464
##   logfeemp_2017 logfeemp_2018 logpov_2017 logpov_2018 pov_prct_2017
## 1     -2.043496     -1.913802   -2.043496   -1.913802     0.1295749
## 2     -1.923672     -1.943329   -1.923672   -1.943329     0.1460696
## 3     -2.159050     -2.123234   -2.159050   -2.123234     0.1154347
## 4     -2.210303     -2.159529   -2.210303   -2.159529     0.1096674
## 5     -2.180429     -2.270736   -2.180429   -2.270736     0.1129930
## 6     -2.233846     -2.366587   -2.233846   -2.366587     0.1071156
##   pov_prct_2018
## 1    0.14751848
## 2    0.14322641
## 3    0.11964406
## 4    0.11537943
## 5    0.10323616
## 6    0.09380029
</code></pre>

<pre><code class="r">nrow(wi_w)
</code></pre>

<pre><code>## [1] 72
</code></pre>

<p>Notice how in this wide format, each variable is one of our poverty percent or female employment percent variables plus an associated year, and now we only have 72 rows in this wide format compared to 144 (72 counties \(\times\) 2 time periods) rows.</p>

<h3>Exploratory (Spatial) Data Analysis</h3>

<p>We will use the 2018 geometries for creating our neighborhood structure and list of spatial weights. To do this, we first create <code>wi_2018geom</code>, which is a simplified <code>sf</code> dataframe that only contains the <code>GEOID</code> variable and the associated county geometries.</p>

<pre><code class="r">wi_2018geom &lt;- wi %&gt;%
    filter(year==2018) %&gt;%
    dplyr::select(GEOID, geometry)
str(wi_2018geom)
</code></pre>

<pre><code>## Classes &#39;sf&#39; and &#39;data.frame&#39;:   72 obs. of  2 variables:
##  $ GEOID   : chr  &quot;55001&quot; &quot;55003&quot; &quot;55005&quot; &quot;55007&quot; ...
##  $ geometry:sfc_MULTIPOLYGON of length 72; first list element: List of 1
##   ..$ :List of 1
##   .. ..$ : num [1:311, 1:2] -90 -90 -90 -90 -90 ...
##   ..- attr(*, &quot;class&quot;)= chr [1:3] &quot;XY&quot; &quot;MULTIPOLYGON&quot; &quot;sfg&quot;
##  - attr(*, &quot;sf_column&quot;)= chr &quot;geometry&quot;
##  - attr(*, &quot;agr&quot;)= Factor w/ 3 levels &quot;constant&quot;,&quot;aggregate&quot;,..: NA
##   ..- attr(*, &quot;names&quot;)= chr &quot;GEOID&quot;
</code></pre>

<p>Next, we will merge <code>wi_2018geom</code> (an <code>sf</code> dataframe that contains the county geometries) with <code>wi_w</code> (a regular dataframe) using the <code>merge()</code> function from the <code>sp</code> package:</p>

<pre><code class="r">#merge 2018 geometries back in
wi_w.sf &lt;- merge(wi_2018geom, wi_w, by=&quot;GEOID&quot;)

nrow(wi_w.sf)
</code></pre>

<pre><code>## [1] 72
</code></pre>

<pre><code class="r">class(wi_w.sf)
</code></pre>

<pre><code>## [1] &quot;sf&quot;         &quot;data.frame&quot;
</code></pre>

<p>Since our data is in <em>wide</em> format, we can create a similar map to the one created above in the <em>long</em> format, by creating 5 separate maps for each time period and then putting them together using the <code>+</code> operator from the <code>patchwork</code> R package. To create a title for the combined plot, we use <code>plot_annotation()</code> and to specify a single legend we use <code>plot_layout(guides = &#39;collect&#39;)</code>, both from the <code>patchwork</code> package.</p>

<pre><code class="r">p18 &lt;- ggplot(wi_w.sf) +
    geom_sf(aes(fill = logpov_2018)) +
    scale_fill_viridis_c(limits = c(-3.2, -1)) +
    coord_sf(datum = NA) +
    theme_minimal() +
    theme(plot.title=element_text(hjust = 0.5)) +
    labs(title = &quot;2018&quot;, fill=&quot;(Log) %Poverty&quot;)

p17 &lt;- ggplot(wi_w.sf) +
    geom_sf(aes(fill = logpov_2017)) +
    scale_fill_viridis_c(limits = c(-3.2, -1)) +
    coord_sf(datum = NA) +
    theme_minimal() +
    theme(plot.title=element_text(hjust = 0.5)) +
    labs(title = &quot;2017&quot;, fill=&quot;(Log) %Poverty&quot;)


#patchwork the plots together
patch1 &lt;- p17 + p18
patch1 + 
    plot_annotation(title=&quot;County-Level (Log) Percent Poverty in Wisconsin Across Time&quot;) +
    plot_layout(guides = &quot;collect&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-23"/></p>

<h3>Create Neighbors</h3>

<p>Creating the neighborhood structure and list of spatial weights is the same as above in <em>long</em> format.</p>

<pre><code class="r">row.names(wi_w.sf) &lt;- wi_w.sf$NAME
head(row.names(wi_w.sf))
</code></pre>

<pre><code>## [1] &quot;Adams County, Wisconsin&quot;    &quot;Ashland County, Wisconsin&quot; 
## [3] &quot;Barron County, Wisconsin&quot;   &quot;Bayfield County, Wisconsin&quot;
## [5] &quot;Brown County, Wisconsin&quot;    &quot;Buffalo County, Wisconsin&quot;
</code></pre>

<pre><code class="r">wi_nb_w &lt;- poly2nb(wi_w.sf, row.names=row.names(wi_w.sf))
str(head(wi_nb_w))
</code></pre>

<pre><code>## List of 6
##  $ : int [1:6] 11 29 39 50 70 72
##  $ : int [1:4] 4 26 51 58
##  $ : int [1:8] 7 9 17 49 55 56 58 66
##  $ : int [1:4] 2 16 58 66
##  $ : int [1:6] 8 31 36 43 45 59
##  $ : int [1:3] 18 47 62
</code></pre>

<pre><code class="r">listw_w &lt;- nb2listw(wi_nb_w, style = &quot;W&quot;)
class(listw_w)
</code></pre>

<pre><code>## [1] &quot;listw&quot; &quot;nb&quot;
</code></pre>

<pre><code class="r">str(head(listw_w$weights))
</code></pre>

<pre><code>## List of 6
##  $ : num [1:6] 0.167 0.167 0.167 0.167 0.167 ...
##  $ : num [1:4] 0.25 0.25 0.25 0.25
##  $ : num [1:8] 0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125
##  $ : num [1:4] 0.25 0.25 0.25 0.25
##  $ : num [1:6] 0.167 0.167 0.167 0.167 0.167 ...
##  $ : num [1:3] 0.333 0.333 0.333
</code></pre>

<pre><code class="r">county_geoms &lt;- st_geometry(wi_w.sf)
cntrd &lt;- st_centroid(county_geoms)
coords &lt;- st_coordinates(cntrd)
head(coords)
</code></pre>

<pre><code>##           X        Y
## 1 -89.77028 43.96915
## 2 -90.67774 46.31502
## 3 -91.84831 45.42355
## 4 -91.20123 46.52309
## 5 -88.00370 44.45278
## 6 -91.75425 44.37959
</code></pre>

<p>To be sure that our neighbors look the same, we can again plot the county geometries, centroids, and neighborhood:</p>

<pre><code class="r">plot(county_geoms)
plot(listw_w, coords, col=&quot;blue&quot;, add=TRUE)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-27"/></p>

<h3>Using <code>strm</code></h3>

<p>The first argument is the model formula. Given that the data is now in <em>wide</em> format, we must manually enter the response and all of the explanatory variables and their lagged terms. The next argument is <code>id</code>, which we set to &ldquo;NAME&rdquo; as each observation is taken at the county-level. We then specify the name of the data set (<code>data=wi_w.sf</code>). We set the argument <code>listw=listw_w</code> to the row-standardized list of spatial weights. We set <code>time=2</code> because there are 2 time periods in the dataset. We set  <code>wide=TRUE</code>, thereby specifying that the data is in <em>wide</em> format. </p>

<pre><code class="r">formula2 &lt;-as.formula(logpov_2018  ~feemp_prct_2017 + feemp_prct_2018 + logpov_2017)
out2 &lt;- strm(formula2, id=&quot;NAME&quot;, data=wi_w.sf, listw= listw_w, time=2, wide=TRUE)
</code></pre>

<pre><code>## The spatio-temporal regression model fitted:
</code></pre>

<pre><code>## logpov_2018 ~ feemp_prct_2017 + feemp_prct_2018 + logpov_2017
</code></pre>

<pre><code class="r">summary(out2)
</code></pre>

<pre><code>## 
## Call:spatialreg::errorsarlm(formula = modframe, listw = listw)
## 
## Residuals:
##        Min         1Q     Median         3Q        Max 
## -0.1164060 -0.0271688 -0.0052208  0.0303804  0.1135471 
## 
## Type: error 
## Coefficients: (asymptotic standard errors) 
##                  Estimate Std. Error z value  Pr(&gt;|z|)
## (Intercept)      0.490040   0.194409  2.5207 0.0117132
## feemp_prct_2017  8.009277   2.792433  2.8682 0.0041281
## feemp_prct_2018 -9.122176   2.765474 -3.2986 0.0009717
## logpov_2017      0.992349   0.018244 54.3924 &lt; 2.2e-16
## 
## Lambda: -0.35546, LR test value: 2.9886, p-value: 0.08385
## Asymptotic standard error: 0.18981
##     z-value: -1.8727, p-value: 0.061103
## Wald statistic: 3.5072, p-value: 0.061103
## 
## Log likelihood: 110.748 for error model
## ML residual variance (sigma squared): 0.0026359, (sigma: 0.051341)
## Number of observations: 72 
## Number of parameters estimated: 6 
## AIC: -209.5, (AIC for lm: -208.51)
</code></pre>

<p>Compare the output from <code>out$res</code> from the <em>long</em> format dataframe and <code>out2</code> from the <em>wide</em> format dataframe and see that they are the same!</p>

<pre><code class="r">out_coefs &lt;- c(as.vector(out$res$coefficients), out$res$lambda)
out_ses &lt;- c(as.vector(out$res$rest.se),out$res$lambda.se)
out_names &lt;- c(attributes(out$res$coefficients)[[1]], &quot;lambda&quot;)

out2_coefs &lt;- c(as.vector(out2$coefficients), out2$lambda)
out2_ses &lt;- c(as.vector(out2$rest.se), out2$lambda.se)
out2_names &lt;- c(attributes(out2$coefficients)[[1]], &quot;lambda&quot;)

out_table &lt;- rbind.data.frame(cbind.data.frame(Term=out_names, Estimate=out_coefs, SE=out_ses, format=rep(&quot;Long format&quot;,length(out_names))),
                              cbind.data.frame(Term=out2_names, Estimate=out2_coefs, SE=out2_ses,format=rep(&quot;Wide format&quot;,length(out2_names))))

out_table %&gt;%
  gt(groupname_col = c(&quot;format&quot;)) %&gt;%
  tab_header(title=&quot;Comparison of Long and Wide format Output&quot;) %&gt;%
  fmt_number(columns = c(Estimate, SE),  decimals = 2) %&gt;%
  cols_label(Term = md(&quot;**Term**&quot;), Estimate=md(&quot;**Estimate**&quot;), SE=md(&quot;**SE**&quot;))
</code></pre>

<p>&lt;!&ndash;html_preserve&ndash;&gt;<div id="votvfrqkmf" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"></p>

<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#votvfrqkmf .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#votvfrqkmf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#votvfrqkmf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#votvfrqkmf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#votvfrqkmf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#votvfrqkmf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#votvfrqkmf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#votvfrqkmf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#votvfrqkmf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#votvfrqkmf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#votvfrqkmf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#votvfrqkmf .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#votvfrqkmf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#votvfrqkmf .gt_from_md > :first-child {
  margin-top: 0;
}

#votvfrqkmf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#votvfrqkmf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#votvfrqkmf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#votvfrqkmf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#votvfrqkmf .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#votvfrqkmf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#votvfrqkmf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#votvfrqkmf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#votvfrqkmf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#votvfrqkmf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#votvfrqkmf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#votvfrqkmf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#votvfrqkmf .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#votvfrqkmf .gt_left {
  text-align: left;
}

#votvfrqkmf .gt_center {
  text-align: center;
}

#votvfrqkmf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#votvfrqkmf .gt_font_normal {
  font-weight: normal;
}

#votvfrqkmf .gt_font_bold {
  font-weight: bold;
}

#votvfrqkmf .gt_font_italic {
  font-style: italic;
}

#votvfrqkmf .gt_super {
  font-size: 65%;
}

#votvfrqkmf .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>

<table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="3" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Comparison of Long and Wide format Output</th>
    </tr>
    
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"><strong>Term</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1"><strong>Estimate</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1"><strong>SE</strong></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_group_heading_row">
      <td colspan="3" class="gt_group_heading">Long format</td>
    </tr>
    <tr><td class="gt_row gt_left">(Intercept)</td>
<td class="gt_row gt_right">0.49</td>
<td class="gt_row gt_right">0.19</td></tr>
    <tr><td class="gt_row gt_left">feemp_prct</td>
<td class="gt_row gt_right">&minus;9.12</td>
<td class="gt_row gt_right">2.77</td></tr>
    <tr><td class="gt_row gt_left">feemp_prct.Tlag1</td>
<td class="gt_row gt_right">8.01</td>
<td class="gt_row gt_right">2.79</td></tr>
    <tr><td class="gt_row gt_left">logpov.Tlag1</td>
<td class="gt_row gt_right">0.99</td>
<td class="gt_row gt_right">0.02</td></tr>
    <tr><td class="gt_row gt_left">lambda</td>
<td class="gt_row gt_right">&minus;0.36</td>
<td class="gt_row gt_right">0.19</td></tr>
    <tr class="gt_group_heading_row">
      <td colspan="3" class="gt_group_heading">Wide format</td>
    </tr>
    <tr><td class="gt_row gt_left">(Intercept)</td>
<td class="gt_row gt_right">0.49</td>
<td class="gt_row gt_right">0.19</td></tr>
    <tr><td class="gt_row gt_left">feemp_prct_2017</td>
<td class="gt_row gt_right">8.01</td>
<td class="gt_row gt_right">2.79</td></tr>
    <tr><td class="gt_row gt_left">feemp_prct_2018</td>
<td class="gt_row gt_right">&minus;9.12</td>
<td class="gt_row gt_right">2.77</td></tr>
    <tr><td class="gt_row gt_left">logpov_2017</td>
<td class="gt_row gt_right">0.99</td>
<td class="gt_row gt_right">0.02</td></tr>
    <tr><td class="gt_row gt_left">lambda</td>
<td class="gt_row gt_right">&minus;0.36</td>
<td class="gt_row gt_right">0.19</td></tr>
  </tbody>
  
  
</table>

<p></div>&lt;!&ndash;/html_preserve&ndash;&gt;</p>

<h1>Working with <code>tidycensus</code></h1>

<p>In this example, we have provided the data used. However the data can be downloaded directly using the <code>tidycensus</code> R package. The code to download the data directly is below. To use <code>tidycensus</code>, you will need to request an API key <a href="https://api.census.gov/data/key_signup.html">here</a>. </p>

<pre><code class="r">#load tidycensus
library(tidycensus)
options(tigris_use_cache = TRUE)
</code></pre>

<h2>Downloading Census Data Using <code>tidycensus</code></h2>

<p>From the <code>tidycensus</code> package, we use the <code>census_api_key()</code> function and specify <code>install=TRUE</code> so that the API key is stored in the local R environment. To access the variables we want from the American Community Survey. It should be noted that using tidycensus, we can also access the 1990, 2000, and 2010 decennial US Census data as well.</p>

<pre><code class="r">census_api_key(&quot;YOUR API KEY HERE&quot;, install=TRUE)
</code></pre>

<p>(You may need to either restart your R session or run <code>readRenviron(&quot;~/.Renviron&quot;)</code> in your console to use the API key immediately.)</p>

<pre><code class="r">vars &lt;- load_variables(2018, &quot;acs5&quot;, cache=TRUE)
years &lt;- lst(2017,2018)
multi_year &lt;- map(years,~ get_acs(geography = &quot;county&quot;,
                                  variables = c(&quot;B17020_001&quot;,&quot;B17020_002&quot;,&quot;B23022_026&quot;,&quot;B23022_001&quot;),
                                  state = &quot;WI&quot;,
                                  year = .x,
                                  geometry = TRUE)) %&gt;%
              map2(years, ~ mutate(.x, id = .y))

wi_raw &lt;- reduce(multi_year, rbind)
</code></pre>

<p>For more examples of working with the <code>tidycensus</code> package, please see the vignettes for <a href="https://walker-data.com/tidycensus/articles/basic-usage.html">basic usage</a> and working with <a href="https://walker-data.com/tidycensus/articles/spatial-data.html">spatial data</a>. Full <code>tidycensus</code> support can be found <a href="https://walker-data.com/tidycensus/index.html">here</a>.</p>

</body>

</html>
